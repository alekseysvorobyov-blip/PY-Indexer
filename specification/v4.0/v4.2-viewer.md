# ТЗ ДЛЯ VIEWER-А ИНДЕКСОВ

## 📋 **ЦЕЛЬ**
Создать веб-интерфейс для визуализации и проверки сгенерированных TECH-индексов.

## 🎯 **БАЗОВЫЕ ТРЕБОВАНИЯ**

### 1. **НАВИГАЦИЯ И СТРУКТУРА**
```
ЛЕВАЯ ПАНЕЛЬ (навигация)
├── 🔍 Поиск по всем сущностям
├── 📁 Файлы (дерево проекта)
├── 🏗️ Классы (список + фильтры)
├── ⚙️ Функции (список + фильтры)
├── 🔗 Импорты (внутренние/внешние)
└── 🕸️ Зависимости (граф вызовов)
```

### 2. **ДЕТАЛЬНЫЙ ПРОСМОТР** (правая панель)
**Для каждой сущности показывать:**

#### 🏗️ **КЛАСС:**
```html
# IndexCLI 🏗️

📍 Файл: cli_index.py (строки 34-154)
👨‍👦 Родитель: <root>

📋 Наследование:
└─ object (встроенный)

🔧 Методы (4):
• __init__ (строки 54-56)
• run (строки 58-122) ⭐
• parse_arguments (строки 124-154)
• _get_output_filename (строки 156-180)

📝 Документация:
"CLI for TECH-INDEX generation. Handles command-line arguments..."

💬 Комментарии (2):
• Line 44: Configure logging
• Line 48: Validate inputs
```

#### ⚙️ **ФУНКЦИЯ/МЕТОД:**
```html
# run ⚙️

📍 Файл: cli_index.py (строки 58-122)
👨‍👦 Родитель: IndexCLI (класс)

🎯 Сигнатура:
def run(args: list[str]) -> int

📊 Параметры:
• args: list[str] (обязательный)

🔄 Вызовы (6 функций):
├─ get_logger
├─ configure_root_logger  
├─ find_python_files
├─ ASTParser.parse_file
├─ CodeIndexer.index_parsed_files
└─ TechIndexBuilder.build

📝 Документация:
"Run TECH-INDEX generation. Parameters: args - command-line arguments..."

💬 Комментарии (8):
• Line 60: Configure logging
• Line 65: Validate inputs
• Line 70: Find Python files
...
```

#### 📁 **МОДУЛЬ (ФАЙЛ):**
```html
# cli_index.py 📁

📍 Путь: /src/cli_index.py
📏 Размер: 312 строк

🏗️ Структура:
├── Классы (1):
│   └─ IndexCLI (строки 34-154)
├── Функции (4):
│   ├─ run (строки 58-122)
│   ├─ parse_arguments (строки 124-154)
│   ├─ _get_output_filename (строки 156-180)
│   └─ _get_serializer (строки 182-200)
└── Импорты (12):
    ├─ argparse, sys, pathlib
    ├─ InputValidator, ASTParser, CodeIndexer
    └─ TechIndexBuilder, JSONSerializer...

🔗 Зависимости (8 файлов):
• validator.py, parser.py, indexer.py...
```

### 3. **ВИЗУАЛЬНЫЕ УЛУЧШЕНИЯ**

#### 🎨 **ИКОНКИ И ЦВЕТА:**
- 📁 **Файл** - синий
- 🏗️ **Класс** - оранжевый  
- ⚙️ **Функция** - зеленый
- 🔗 **Импорт** - фиолетовый
- 💬 **Комментарий** - серый
- ⚠️ **Проблема** - красный

#### 📊 **ИНДИКАТОРЫ КАЧЕСТВА:**
```html
✅ Корректные связи
⚠️ Предупреждения (2):
• Функция не имеет докстринга
• Неиспользуемый импорт
❌ Ошибки (1):
• Циклическая зависимость
```

### 4. **ПРОВЕРОЧНЫЕ ФУНКЦИИ**

#### 🔍 **ВАЛИДАЦИЯ ИНДЕКСОВ:**
```javascript
// Проверка целостности
validateIndexes() {
  // 1. Все location_id должны быть уникальны
  // 2. parent_location_id должны существовать
  // 3. call_graph связи должны быть двусторонними
  // 4. Импорты должны ссылаться на существующие модули
  // 5. MRO цепочки не должны содержать циклов
}
```

#### 📈 **СТАТИСТИКА ПРОЕКТА:**
```html
📊 Статистика проекта:
├── Файлы: 45
├── Классы: 23
├── Функции: 187
├── Строки кода: 12,458
├── Документация: 78% покрытие
└── Комментарии: 342
```

### 5. **ИНТЕРАКТИВНЫЕ ВОЗМОЖНОСТИ**

#### 🎯 **БЫСТРЫЕ ДЕЙСТВИЯ:**
- 🔍 **Поиск использования** - где используется сущность
- 🕸️ **Показать граф** - визуализация зависимостей
- 📋 **Копировать сигнатуру** - для использования в коде
- 🔗 **Перейти к определению** - переход по ссылкам

#### 📱 **ФИЛЬТРЫ И СОРТИРОВКИ:**
```javascript
filters: {
  byType: ['class', 'function', 'import'],
  byFile: 'cli_index.py',
  byVisibility: ['public', 'private'],
  hasDocs: true,
  hasIssues: true
}
```

## 🚀 **ТЕХНИЧЕСКИЕ ТРЕБОВАНИЯ**

### 📁 **ФОРМАТ ДАННЫХ:**
```javascript
// Загрузка индексов
loadIndexes({
  techIndex: 'tech-index-v4.3.msgpack',
  techLocation: 'tech-location-v4.0.msgpack', 
  techDocstrings: 'tech-docstrings-v4.0.msgpack',
  techComments: 'tech-comments-v4.msgpack',
  techMap: 'tech-map-v1.2.msgpack'
})
```

### 🔧 **API ДЛЯ ИНТЕГРАЦИИ:**
```javascript
// Получение информации о сущности
getEntity(locationId) {
  return {
    basic: fromTechLocation,
    structure: fromTechIndex, 
    docs: fromTechDocstrings,
    comments: fromTechComments
  }
}

// Поиск по имени
searchEntities(query) {
  return techMap.indexes.by_name[query]
}
```

## 📋 **ПРИОРИТЕТЫ РЕАЛИЗАЦИИ**

### 🥇 **ВЫСОКИЙ ПРИОРИТЕТ:**
1. Навигация по файлам и базовый просмотр
2. Отображение структуры классов и функций  
3. Валидация целостности индексов
4. Поиск и фильтрация

### 🥈 **СРЕДНИЙ ПРИОРИТЕТ:**
1. Визуализация графов зависимостей
2. Статистика и метрики качества
3. Интерактивные переходы между сущностями

### 🥉 **НИЗКИЙ ПРИОРИТЕТ:**
1. Экспорт отчетов
2. Сравнение версий индексов
3. Расширенная аналитика

## 🎯 **КРИТЕРИИ УСПЕХА**

### ✅ **МИНИМАЛЬНАЯ РАБОЧАЯ ВЕРСИЯ:**
- Загрузка и отображение TECH-индексов
- Навигация по структуре проекта  
- Проверка целостности связей
- Поиск сущностей по имени

### ✅ **ПОЛНАЯ ВЕРСИЯ:**
- Визуализация графов зависимостей
- Детальная статистика и метрики
- Интерактивная навигация между сущностями
- Экспорт отчетов о качестве кода

Такой viewer позволит тебе визуально проверять корректность сгенерированных индексов и понимать структуру проекта без чтения исходного кода.